<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-references/user-stitching" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">User Stitching | GA4Dataform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.ga4dataform.com/img/social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.ga4dataform.com/img/social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.ga4dataform.com/docs/user-stitching"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="User Stitching | GA4Dataform"><meta data-rh="true" name="description" content="what is it? how does it work?"><meta data-rh="true" property="og:description" content="what is it? how does it work?"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.ga4dataform.com/docs/user-stitching"><link data-rh="true" rel="alternate" href="https://docs.ga4dataform.com/docs/user-stitching" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.ga4dataform.com/docs/user-stitching" hreflang="x-default"><script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-MRWXP5MT",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>
<script src="https://www.googletagmanager.com/gtm.js?id=GTM-MRWXP5MT" async></script><link rel="stylesheet" href="/assets/css/styles.8205ab49.css">
<script src="/assets/js/runtime~main.716e396e.js" defer="defer"></script>
<script src="/assets/js/main.778cee1b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ga4dataform" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ga4dataform" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">GA4Dataform</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/superformlabs/ga4dataform-community/issues/new" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Suggest an edit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/get-started">Get Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/whats-next">What&#x27;s Next After Installation?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/installer">Installer</a><button aria-label="Expand sidebar category &#x27;Installer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/core-concepts">Core Concepts</a><button aria-label="Expand sidebar category &#x27;Core Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/guides">Guides</a><button aria-label="Expand sidebar category &#x27;Guides&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/references">References</a><button aria-label="Collapse sidebar category &#x27;References&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/misattribution-fixes">Misattribution Fixes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/default-channel-grouping">Default Channel Grouping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hidden-configuration">Hidden Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/assertions">Assertions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installer-permissions">Installer Permissions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/transaction-model-references">Transaction Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/labelling">Labeling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/report-cvr-per-events">Report CVR per events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/user-stitching">User Stitching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/items-tables">Items tables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/references-others">Other References</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/data-dictionary">Data Dictionary</a><button aria-label="Expand sidebar category &#x27;Data Dictionary&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faq">FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/support-contact">Support &amp; Contact</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/changelog">Changelog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/resources">Resources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/about">About</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><hr style="margin: 8px 0; border-top: 1px solid #ddd;"></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/google-cloud-platform-academy">Google Cloud Platform Academy</a><button aria-label="Expand sidebar category &#x27;Google Cloud Platform Academy&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/dataform-academy">Dataform Academy</a><button aria-label="Expand sidebar category &#x27;Dataform Academy&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/references"><span itemprop="name">References</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">User Stitching</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>User Stitching</h1></header><div class="admonition admonition--premium"><div class="premium-heading"><span class="premium-icon">üíé</span>Premium Feature</div><div class="admonition-content"><p>This feature is exclusive for Premium users</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-it-does">What it does<a href="#what-it-does" class="hash-link" aria-label="Direct link to What it does" title="Direct link to What it does">‚Äã</a></h2>
<p>The user stitching functionality will look at the cookie of the user (user_pseudo_id) and ‚Äúfill in gaps‚Äù of certain column - most notably the user_id. It does this on the session level.</p>
<p>Concrete:</p>
<p>if a visitor (user_pseudo_id) has a session <em>without</em> a user_id‚Ä¶</p>
<ul>
<li>we will look back in time to find if that visitor in the past has had a session <em>with</em> a <code>user_id</code>, and assign the <code>user_id</code> to that session, and we will use the <em>last</em> seen <code>user_id</code> to fill in the blanks</li>
<li>if there is no session in the past with a <code>user_id</code>, we will look in the future to find one. This effectively <strong>rewrites the history</strong> and de-anonimises sessions leading up to a login (so be careful)</li>
</ul>
<p>The stitching is not restricted to <code>user_id</code> only: if you have (custom) parameters, user_properties, url_params, you can stitch them via the same procedure.</p>
<p>For example, you can stitch columns like <code>url_params_custom.lead_id</code> , <code>event_params_custom.email_hash</code>, <code>user_properties.store_location</code>, etc.</p>
<p>The results are stored in the column <code>stitched_ids</code> in the <code>ga4_sessions</code> table, as a struct</p>
<p><img decoding="async" loading="lazy" alt="screenshot" src="data:image/png;base64,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" width="296" height="131" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">‚Äã</a></h2>
<p>Default config has 1 object with 4 keys:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  USER_STITCHING: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enabled: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dimensions: [],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lookBackDays: 90,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lookAheadDays: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>enabled</code> can be</p>
<ul>
<li>true: this will stitch <code>user_id</code> (the built in column), and optional other dimensions</li>
<li>false: this will skip user stitching logic</li>
</ul>
<p><code>dimensions</code> - this is an array of objects, the object must have 2 keys</p>
<ul>
<li><code>name</code>: the column name as it appears in <code>ga4_events</code></li>
<li><code>renameTo</code>: the column name as it will appear in the <code>stitched_ids</code> struct in <code>ga4_sessions</code></li>
</ul>
<p>Note: If no <code>renameTo</code> field is used, the full (sanitized) name is used. So <code>event_params_custom.lead_id</code> will become <code>event_params_custom_lead_id</code></p>
<p><code>lookBackDays</code> is the number of days to search for a previous value.</p>
<p><code>lookAheadDays</code> is the number of days to ‚Äúrewrite the past‚Äù with a possible future value.</p>
<p>Example config:</p>
<div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token constant" style="color:#36acaa">USER_STITCHING</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">enabled</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">dimensions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user_properties.datatrics_segment&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">renameTo</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;datatrics_segment&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;event_params.showroom_name&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">lookBackDays</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">lookAheadDays</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works-in-the-sql">How it works in the SQL<a href="#how-it-works-in-the-sql" class="hash-link" aria-label="Direct link to How it works in the SQL" title="Direct link to How it works in the SQL">‚Äã</a></h2>
<p><code>int_ga4_sessions</code> will store the first and last values of the dimension in a struct <code>stitched_ids</code></p>
<p>These will be used in <code>ga4_sessions</code> to fetch the values. Of course: only when the stitching is enabled.</p>
<p>In <code>ga4_sessions</code></p>
<ul>
<li><code>lookBackDays</code> of days will be read from the intermediate table</li>
<li>like the ‚Äúlast non direct‚Äù session source, the last found value of the dimension will be filled in and saved</li>
<li>backstitching will be applied afterwards using the <code>lookAheadDays</code> time window</li>
</ul>
<p>Not that this order matters: leading NULL values will be filled in <em>after</em> trailing NULL values.</p>
<p>Let‚Äôs say you configure</p>
<ul>
<li>1 day of lookback</li>
<li>1 day of lookahead</li>
</ul>
<p>In the below diagram, ‚Äúday 4‚Äù will be filled in with <code>A</code> - because this is processed in the first round.</p>
<p><img decoding="async" loading="lazy" alt="screenshot" src="/assets/images/stitching_logic-75127ee31392279a8ec4ac71cd68e729.png" width="546" height="338" class="img_ev3q"></p>
<p>Had the configuration be</p>
<ul>
<li>0 days of lookback</li>
<li>1 day of lookahead</li>
</ul>
<p>The result would be to skip the first round, and backstich in round 2, like this:</p>
<p><img decoding="async" loading="lazy" alt="screenshot" src="/assets/images/stitching_logic_round2-315f11ba0765edc7366e1df324c991b7.png" width="554" height="327" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="limitations-and-caveats">Limitations and caveats<a href="#limitations-and-caveats" class="hash-link" aria-label="Direct link to Limitations and caveats" title="Direct link to Limitations and caveats">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-if-you-lose-too-much-information">Check if you lose too much information<a href="#check-if-you-lose-too-much-information" class="hash-link" aria-label="Direct link to Check if you lose too much information" title="Direct link to Check if you lose too much information">‚Äã</a></h3>
<p>The stitching is done on session level, not on event level. This means that only 1 stitched value per session is stored.</p>
<p>If you have a lot of cases where one browser logs in to many user accounts multiple times per session, the stitching might lose some of its value, since more values get dropped.</p>
<p>A query to check if your user identifier is ‚Äúsession-stitchable‚Äù (or: less than 5% of sessions have multiple identifiers)</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> freq </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    session_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">distinct</span><span class="token plain"> event_params_custom</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">email_hash</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> n_user_ids  </span><span class="token comment" style="color:#999988;font-style:italic">-- replace this with user_id or other identifier</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">superform_outputs.ga4_events</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    event_date </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2025-09-01&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- choose date range</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> session_id </span><span class="token operator" style="color:#393A34">is</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">not</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> user_pseudo_id </span><span class="token operator" style="color:#393A34">is</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">not</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> session_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agg </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sessions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    countif</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_user_ids </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> no_login</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    countif</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_user_ids </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> one_login</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    countif</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_user_ids </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> multiple_logins</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> freq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sessions </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> sessions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;Of the &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> no_login</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;% of sessions where a user_id is found, &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> safe_divide</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">multiple_logins </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> one_login</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;% have multiple user_ids.&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> safe_divide</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">multiple_logins </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> one_login</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;yes&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;reconsider&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> should_I_stitch  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> agg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lookaheaddays-rewrites-history">lookAheadDays rewrites history<a href="#lookaheaddays-rewrites-history" class="hash-link" aria-label="Direct link to lookAheadDays rewrites history" title="Direct link to lookAheadDays rewrites history">‚Äã</a></h3>
<p>The main difference between lookback and lookahead is the following:</p>
<ul>
<li>lookback: I see an anonymous session <strong>today</strong> with a login 10 days ago: let‚Äôs assign a user_id to the session of <strong>today</strong></li>
<li>lookahead: the anonymous user where I stored an anonymous session <strong>10 days ago</strong>, has logged in session today, so let‚Äôs change the user_id field for the session from <strong>10 days ago</strong></li>
</ul>
<p>In the lookahead case, this means that a query you execute in week 22 to get data from  ‚Äúweek 21‚Äù, can have a different output if you run it in week 23.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="respect-user-privacy">Respect user privacy<a href="#respect-user-privacy" class="hash-link" aria-label="Direct link to Respect user privacy" title="Direct link to Respect user privacy">‚Äã</a></h3>
<p>As a final note, be mindul of user choices  and privacy when stitching data. If you use stitched data to enrich customer profiles with information gathered while they were logged out, it may not be what they expect. Or even what you promised in your own privacy policy.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/&lt;your-org&gt;/&lt;your-repo&gt;/edit/main/docs/docs/references/user-stitching.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/report-cvr-per-events"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Report CVR per events</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/items-tables"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Items tables</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-it-does" class="table-of-contents__link toc-highlight">What it does</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#how-it-works-in-the-sql" class="table-of-contents__link toc-highlight">How it works in the SQL</a></li><li><a href="#limitations-and-caveats" class="table-of-contents__link toc-highlight">Limitations and caveats</a><ul><li><a href="#check-if-you-lose-too-much-information" class="table-of-contents__link toc-highlight">Check if you lose too much information</a></li><li><a href="#lookaheaddays-rewrites-history" class="table-of-contents__link toc-highlight">lookAheadDays rewrites history</a></li><li><a href="#respect-user-privacy" class="table-of-contents__link toc-highlight">Respect user privacy</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/get-started">Get Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/references">References</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/guides">Guides</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/category/data-dictionary">Data Dictionary</a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/privacy-policy">Privacy Policy</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://ga4dataform.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GA4Dataform<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2025 Superform Labs. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>