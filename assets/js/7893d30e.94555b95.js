"use strict";(self.webpackChunkga_4_dataform=self.webpackChunkga_4_dataform||[]).push([[7440],{1526:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var t=s(4848),i=s(8453);const r={title:"Configuration Variables",description:"Detailed review of configuration variables",slug:"/configuration-variables"},a=void 0,o={id:"references/configuration-variables",title:"Configuration Variables",description:"Detailed review of configuration variables",source:"@site/docs/references/configuration-variables.md",sourceDirName:"references",slug:"/configuration-variables",permalink:"/docs/configuration-variables",draft:!1,unlisted:!1,editUrl:"https://github.com/<your-org>/<your-repo>/edit/main/docs/docs/references/configuration-variables.md",tags:[],version:"current",frontMatter:{title:"Configuration Variables",description:"Detailed review of configuration variables",slug:"/configuration-variables"},sidebar:"tutorialSidebar",previous:{title:"Items Funnel Report",permalink:"/docs/modules/items-funnel-report"},next:{title:"Misattribution Fixes",permalink:"/docs/misattribution-fixes"}},l={},c=[{value:"Events to Count (<code>eventsToCount</code>)",id:"events-to-count-eventstocount",level:5},{value:"Unique Fields (<code>uniqueFields</code>)",id:"unique-fields-uniquefields",level:5},{value:"Sum Fields (<code>sumFields</code>)",id:"sum-fields-sumfields",level:5}];function d(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h5:"h5",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components},{Details:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Click on each card below to see more details!"}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Full Custom Config file (for easy copying)"}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Below is a full, ready-to-copy, Premium compatible custom config file (",(0,t.jsx)(n.code,{children:"includes/custom/config.js"}),") that you can use if you updated from Core (since we don't overwrite ",(0,t.jsx)(n.code,{children:"config.js"})," files during updates)."]}),(0,t.jsx)(n.admonition,{title:"Existing variables",type:"warning",children:(0,t.jsx)(n.p,{children:"Remember to save your current variables before proceeding - you'll need to restore them afterward."})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const { helpers } = require("../core/helpers");\nconst lowerSQL = helpers.lowerSQL;\n\n/*\n    ga4dataform runs the core model with SQL that can be tweaked with\n    configuration settings in this file.\n\n    Below, you will find a sample config file that you can tweak to\n    your likings.\n\n    See the documentation for all details.\n*/\n\n// config object should be a valid javascript object\n\n\nconst customConfig = {\n  // on a new or full build, this start date will be picked\n\n  GA4_START_DATE: "2020-01-01",\n\n  // include support for fresh and intraday tables?\n  // These can both be enabled, only 1 tableset per day is used\n  // events_ takes priority over fresh_, takes priority over intraday_\n  USE_FRESH_EVENTS: true,\n  USE_INTRADAY_EVENTS: false,\n\n  // custom definitions\n  // a very complete list of all recommended and standard event parameters is\n  // included in the `event_params` column.\n  // If you have custom definitions, add them here and they will appear in \n  // the `events_params_custom` column.\n\n  // all custom_ arrays should be in the form:\n  // \n  // { name: "paramname", type: "TYPE", renameTo: "outputcolumnname" }\n  //\n  // "paramname" will be extracted from the data (event param / user property / item custom dim / url parameter)\n  // TYPE will be the column type.\n  // - "int" -> look for int_value, store as INT\n  // - "string" -> look for all values, store as STRING\n  // - "decimal" -> look for all numerical values, store as FLOAT\n  // options:\n  // - "renameTo" -> name the output column to this name. Default: "paramname" will be used\n  // cleaningMethod: lowerSQL -> transform the output (of strings) to lower case\n \n  // event dimensions and metrics\n  // example:\n  // CUSTOM_EVENT_PARAMS_ARRAY: [\n  //    { name: "event_value", type: "decimal" },\n  //    { name: "event_value", type: "string", renameTo: "event_value_string" }\n  // ],\n  CUSTOM_EVENT_PARAMS_ARRAY: [],\n\n  // user properties\n  // example:\n  // CUSTOM_USER_PROPERTIES_ARRAY: [\n  //    { name: "lifetime_value",   type: "decimal" }\n  // ],\n  CUSTOM_USER_PROPERTIES_ARRAY: [],\n\n  // item custom dimensions and metrics\n  // these will appear in `items.item_params_custom.*`\n  // example:\n  // CUSTOM_ITEM_PARAMS_ARRAY: [\n  //    { name: "stock_status", type: "string" }\n  // ]\n  CUSTOM_ITEM_PARAMS_ARRAY: [],\n\n  // URL parameters to extract to own column\n  // (note: all standard utm params are already extracted to `url_params`)\n  // custom url params will appear in `url_params_custom`\n  // (this does NOT support the "type" key: only strings are supported)\n\n  // Examples based on internal search engine params:\n  //   CUSTOM_URL_PARAMS_ARRAY: [\n  //      { name: "q", cleaningMethod: lowerSQL },\n  //      { name: "s", cleaningMethod: lowerSQL },\n  //      { name: "search",cleaningMethod: lowerSQL }\n  //   ],\n  CUSTOM_URL_PARAMS_ARRAY: [],\n\n  // include session-level custom parameters in the sessions table. These will end up in\n  // int_ga4_sessions and ga4_sessions in the column `session_params_custom`.\n  // In the "pick" property you can choose how you want to select a single value\n  // of a parameter per session. It supports: first, last, min, max, boolean methods.\n  // example:\n  // CUSTOM_SESSION_PARAMS_ARRAY: [\n  //   { name: "event_params_custom.lead_id", pick: "first", renameTo: "initial_lead_id", description: "First lead ID captured in session" },\n  //   { name: "event_params_custom.lead_status", pick: "last", renameTo: "final_lead_status", description: "Final lead qualification status in session" },\n  //   { name: "safe_cast(event_params_custom.engagement_score as INT64)", pick: "max", renameTo: "peak_engagement_score", description: "Highest user engagement score achieved in session" },\n  //   { name: "safe_cast(event_params_custom.plan_price as NUMERIC)", pick: "min", renameTo: "lowest_price_viewed", description: "Lowest pricing plan amount viewed in session" },\n  //   { name: "event_params_custom.feature_tier", pick: "boolean", renameTo: "viewed_premium_features", description: "Whether user explored premium feature tiers" }\n  // ],\n  // Warning: item fields are not (yet) supported!\n  CUSTOM_SESSION_PARAMS_ARRAY: [],\n \n  // provide a list of fields you want to aggregate. These will end up in \n  // int_ga4_sessions and ga4_sessions in the corresponding STRUCT `totals.count/distinct_count/has_event/sum`\n  // examples that show allowed formatting options:\n  // CUSTOM_SESSION_TOTALS: {\n  //   eventsToCount: [\n  //     \'page_view\',\n  //     { name: \'sign_up\', renameTo: \'registrations\'},\n  //     { name: [\'video_start\', \'video_progress\', \'video_complete\'], renameTo: \'video_engagement\' }\n  //   ],\n  //   uniqueFields: [\n  //     { name: \'ecommerce.transaction_id\', renameTo: \'unique_transactions\' },\n  //     { name: \'event_params.currency\', renameTo: \'funnel_currencies\', eventFilter: [\'begin_checkout\', \'purchase\'] },\n  //   ],\n  //   sumFields: [\n  //     \'event_params.video_duration\',\n  //     { name: \'event_params.engagement_time_msec\', renameTo: \'total_engagement_time\' },\n  //     { name: \'ecommerce.purchase_revenue\', eventFilter: \'purchase\', renameTo: \'purchase_revenue\' },\n  //     { name: \'ecommerce.shipping_value\', eventFilter: [\'purchase\', \'refund\'], renameTo: \'net_shipping_value\' },\n  //   ]\n  // },\n  // Warning: item fields are not (yet) supported!\n  CUSTOM_SESSION_TOTALS: {\n    eventsToCount: [],\n    uniqueFields: [],\n    sumFields: [],\n  },\n\n  // filters\n  // array: list the event names you want to exclude from the events table \n  EVENTS_TO_EXCLUDE: [],\n  // arrays: list the hostnames you want to exclude (or include) from the events table\n  // for including/excluding NULL values, use the empty string ( "" )\n  HOSTNAME_EXCLUDE: [],\n  HOSTNAME_INCLUDE_ONLY: [],\n\n  // Set this to true to enable "Organic AI" (and possible other future channels that\n  // are not compatible with GA4)\n  EXTRA_CHANNEL_GROUPS: true,\n\n  // attribution\n  // if a visitors lands on your site without a source, we look back to\n  // find a previous session of this user with a source. How many days?\n  LAST_NON_DIRECT_LOOKBACK_DAYS: 90,\n\n  \n  // USER STITCHING object:\n  // if enabled, we overwrite the user_id column in the ga4_sessions table based on user_pseudo_id\n\n  // you can choose to add more stitching columns in the \'dimensions\' array.\n  // make sure the column names exist in the ga4_events table.\n  // the output column in the sessions table will be a struct "stitched_ids" with these columns in them\n  //\n  // example:\n  //    dimensions: [ \n  //      { name: "user_properties.customer_segment", renameTo: "customer_segment" },\n  //      { name: "event_params.lead_id", renameTo: "lead_id" }\n  //  ],\n  //\n  // lookBackDays: if session is found without a user_id, we look back to\n  // find a previous session of this user with a user_id. How many days?\n  // (default: 90, like the campaign lookback)\n  //\n  // lookAheadDays:  if session is found without a user_id in the past, we look ahead to \n  // find a future session of this user with a user_id. How many days?\n  // Note: this will overwrite "already processed days" to de-anonimise sessions\n  // (default: 0)\n\n  USER_STITCHING: {\n    enabled: false,\n    dimensions: [],\n    lookBackDays: 90,\n    lookAheadDays: 10\n  },\n\n  // Use CUSTOM_EVENT_ID_PARAMETER to add another custom event parameter to the event_id\n  // creation that makes an event unique. We usually recommend using a UNIX timestamp.\n  CUSTOM_EVENT_ID_PARAMETER: \'\',\n\n  // For the ga4_transactions table:\n  // by default, we leave duplicate transaction_ids alone, but you can deduplicate here\n  // note: setting this to true will still keep all transactions with NULL transaction_id\n  TRANSACTIONS_DEDUPE: true,\n  // we keep a running count for transactions, based on an identifier. Defaults to "user_pseudo_id"\n  // if you have an other one, you can change it here (e.g. "user_id" - make sure it\'s a valid column)\n  TRANSACTION_TOTALS_UID: \'user_pseudo_id\',\n\n  // assertions and quality checks can be toggled on (true) or off (false) here\n  // quality checks can be toggled off by changing to false\n\n  // assertions\n  // id uniqueness checks\n  ASSERTIONS_EVENT_ID_UNIQUENESS: false,\n  ASSERTIONS_SESSION_ID_UNIQUENESS: false,\n\n  // check for session durations and events look valid?\n  ASSERTIONS_SESSION_DURATION_VALIDITY: false,\n  ASSERTIONS_SESSIONS_VALIDITY: false, \n  // check GA4 tables: are they on time?\n  ASSERTIONS_TABLES_TIMELINESS: false,\n  // check for a transaction IDs on a purchase?\n  ASSERTIONS_TRANSACTION_ID_COMPLETENESS: false,\n  // check for cookies on all hits? (note: cookieless pings will trigger a fail)\n  ASSERTIONS_USER_PSEUDO_ID_COMPLETENESS: false,\n\n}\n\n\n\nmodule.exports = {\n    customConfig\n};\n'})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"GA4 Start Date"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'GA4_START_DATE: "2020-01-01"\n'})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Defines the starting date for the GA4 data that the model should process.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Change this date to reflect the earliest data you want to include in your reports. For example, if you started collecting GA4 data on a different date, modify this to match that date."]})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Use Fresh Events \ud83d\udc8e"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"USE_FRESH_EVENTS: true\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": If you set this to true, ",(0,t.jsx)(n.code,{children:"ga4_events"})," will query from ",(0,t.jsx)(n.code,{children:"fresh"})," table shards if they are available. If ",(0,t.jsx)(n.code,{children:"events_*"})," table also exists for the same date, that will be used. Priority for same date shards: 1. regular ",(0,t.jsx)(n.code,{children:"events_"})," 2. ",(0,t.jsx)(n.code,{children:"fresh_"})," (if enabled) 3. ",(0,t.jsx)(n.code,{children:"intraday_"})," (if enabled)"]})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Use Intraday Events \ud83d\udc8e"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"USE_INTRADAY_EVENTS: false\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": If you set this to true, ",(0,t.jsx)(n.code,{children:"ga4_events"})," will query from ",(0,t.jsx)(n.code,{children:"intraday"})," table shards if they are available. Priority for same date shards: 1. regular ",(0,t.jsx)(n.code,{children:"events_"})," 2. ",(0,t.jsx)(n.code,{children:"fresh_"})," (if enabled) 3. ",(0,t.jsx)(n.code,{children:"intraday_"})," (if enabled)"]})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Custom Event Parameters"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"CUSTOM_EVENT_PARAMS_ARRAY: []\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": This allows you to specify custom event parameters that are not part of the standard GA4 data. The custom parameters will be added to the ",(0,t.jsx)(n.code,{children:"event_params_custom"})," column in the ",(0,t.jsx)(n.code,{children:"ga4_events"})," table.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Add parameters using the format ",(0,t.jsx)(n.code,{children:'{ name: "paramname", type: "TYPE", renameTo: "outputcolumnname", description: "This parameter means XYZ" }'}),"."]}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"name"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required"}),". The original event parameter name to extract"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"type"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required"}),". Data type for extraction and storage. ",(0,t.jsx)(n.code,{children:"int"}),": Extracts from int_value, stores as INT; ",(0,t.jsx)(n.code,{children:"string"}),": Extracts from all values, stores as STRING; ",(0,t.jsx)(n.code,{children:"decimal"}),": Extracts from all numerical values, stores as FLOAT"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"renameTo"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". New name for the output column. If not specified, original parameter name is used"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"cleaningMethod"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Transformation method to apply: ",(0,t.jsx)(n.code,{children:"lowerSQL"}),": Converts string outputs to lowercase"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"description"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Add a description for a column that will show up in the table schema"]})]})]})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'CUSTOM_EVENT_PARAMS_ARRAY: [\n  { name: "gtm_info", type: "string", description: "GTM container ID + container version"},\n  { name: "consent", type: "string", description: "The current consent status of the user"},\n  { name: "page_type", type: "string", description: "The type of page: category, listing, product, home, checkout" }\n]\n'})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"User Properties"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"CUSTOM_USER_PROPERTIES_ARRAY: []\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Allows you to extract user properties into their own columns.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Define user properties you want to extract in the format ",(0,t.jsx)(n.code,{children:'{ name: "param_name", cleaningMethod: method }'}),". These will be stored in the ",(0,t.jsx)(n.code,{children:"user_properties"})," column in the ",(0,t.jsx)(n.code,{children:"ga4_events"})," table."]}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"name"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required"}),". The original user property name to extract"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"type"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required"}),". Data type for extraction and storage. ",(0,t.jsx)(n.code,{children:"int"}),": Extracts from int_value, stores as INT; ",(0,t.jsx)(n.code,{children:"string"}),": Extracts from all values, stores as STRING; ",(0,t.jsx)(n.code,{children:"decimal"}),": Extracts from all numerical values, stores as FLOAT"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"renameTo"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". New name for the output column. If not specified, original parameter name is used"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"cleaningMethod"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Transformation method to apply: ",(0,t.jsx)(n.code,{children:"lowerSQL"}),": Converts string outputs to lowercase"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"description"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Add a description for a column that will show up in the table schema"]})]})]})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'  CUSTOM_USER_PROPERTIES_ARRAY: [\n  { name: "user_tier", type: "string", description: "The loyalty tier of the user (e.g., \'gold\', \'silver\')" },\n  { name: "lifetime_value", type: "decimal", renameTo: "ltv", description: "The calculated lifetime value of the user" },\n  { name: "first_purchase_date", type: "string", description: "The date of the user\'s first purchase" }\n]\n'})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Custom Item Parameters"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"CUSTOM_ITEM_PARAMS_ARRAY: []\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Similar to event parameters, but for item custom dimensions and metrics. These will be stored in the ",(0,t.jsx)(n.code,{children:"items.item_params_custom.*"})," column in the ",(0,t.jsx)(n.code,{children:"ga4_events"})," table.\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Add custom item parameters in the same format."]}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"name"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required"}),". The original item parameter name to extract"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"type"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required"}),". Data type for extraction and storage. ",(0,t.jsx)(n.code,{children:"int"}),": Extracts from int_value, stores as INT; ",(0,t.jsx)(n.code,{children:"string"}),": Extracts from all values, stores as STRING; ",(0,t.jsx)(n.code,{children:"decimal"}),": Extracts from all numerical values, stores as FLOAT"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"renameTo"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". New name for the output column. If not specified, original parameter name is used"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"cleaningMethod"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Transformation method to apply: ",(0,t.jsx)(n.code,{children:"lowerSQL"}),": Converts string outputs to lowercase"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"description"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Add a description for a column that will show up in the table schema"]})]})]})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'CUSTOM_ITEM_PARAMS_ARRAY: [\n  { name: "stock_status", type: "string", description: "Whether the item is currenly in_stock/low_stock/out_of_stock", cleaningMethod: lowerSQL },\n  { name: "stock_amount", type: "string", description: "The amount of items currently in stock" },\n  { name: "margin", type: "decimal", description: "Encoded margin for the item. It can be decoded for readability." }\n]\n'})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Custom URL Parameters"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"CUSTOM_URL_PARAMS_ARRAY: []\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Allows you to extract custom URL parameters into their own columns. These will be stored in the ",(0,t.jsx)(n.code,{children:"url_params_custom.*"})," column in the ",(0,t.jsx)(n.code,{children:"ga4_events"})," table.\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Define custom URL parameters you want to extract in the format ",(0,t.jsx)(n.code,{children:'{ name: "q", renameTo: "query_parameter", cleaningMethod: lowerSQL }'}),".\nNote that URL params will always be strings."]}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"name"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required"}),". The original item parameter name to extract"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"renameTo"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". New name for the output column. If not specified, original parameter name is used"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"cleaningMethod"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Transformation method to apply: ",(0,t.jsx)(n.code,{children:"lowerSQL"}),": Converts string outputs to lowercase"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"description"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Add a description for a column that will show up in the table schema"]})]})]})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'CUSTOM_URL_PARAMS_ARRAY: [\n  { name: "q", cleaningMethod: lowerSQL },\n  { name: "product-size", renameTo: "size" }\n]\n'})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Custom Session Parameters \ud83d\udc8e"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"  CUSTOM_SESSION_PARAMS_ARRAY: []\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Include session-level custom parameters in the sessions table. These will appear in ",(0,t.jsx)(n.code,{children:"int_ga4_sessions"})," and ",(0,t.jsx)(n.code,{children:"ga4_sessions"})," tables in the ",(0,t.jsx)(n.code,{children:"session_params_custom"})," column.\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Add parameters with aggregation methods to select a single value per session."]}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"name"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required"}),". The full path to the parameter to aggregate (e.g., ",(0,t.jsx)(n.code,{children:"event_params_custom.lead_id"}),"). It should exist in the ",(0,t.jsx)(n.code,{children:"ga4_events"})," table."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"pick"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Required"}),". The method to select a single value: ",(0,t.jsx)(n.code,{children:"first"})," (first non-null value based on timestamp), ",(0,t.jsx)(n.code,{children:"last"})," (last non-null value), ",(0,t.jsx)(n.code,{children:"min"}),", ",(0,t.jsx)(n.code,{children:"max"}),", ",(0,t.jsx)(n.code,{children:"boolean"})," (true if the parameter exists with any value at least once)."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"renameTo"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". New name for the output column. If not specified, original parameter name is used"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"cleaningMethod"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Transformation method to apply: ",(0,t.jsx)(n.code,{children:"lowerSQL"}),": Converts string outputs to lowercase"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"description"})}),(0,t.jsxs)(n.td,{children:[(0,t.jsx)(n.strong,{children:"Optional"}),". Add a description for a column that will show up in the table schema"]})]})]})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'  CUSTOM_SESSION_PARAMS_ARRAY: [\n    { name: "event_params_custom.lead_id", pick: "first", renameTo: "initial_lead_id", description: "First lead ID captured in session" },\n    { name: "event_params_custom.lead_status", pick: "last", renameTo: "final_lead_status", description: "Final lead qualification status in session" },\n    { name: "safe_cast(event_params_custom.engagement_score as INT64)", pick: "max", renameTo: "peak_engagement_score", description: "Highest user engagement score achieved in session" },\n    { name: "event_params_custom.feature_tier", pick: "boolean", renameTo: "viewed_premium_features", description: "Whether user explored premium feature tiers" }\n  ]\n'})}),(0,t.jsx)(n.admonition,{title:"Item fields are not (yet) supported!",type:"warning",children:(0,t.jsxs)(n.p,{children:["This will throw an error:",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.code,{children:'{ name: "items.item_params_custom.stock_status", pick: "first" }'})]})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Custom Session Totals \ud83d\udc8e"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"CUSTOM_SESSION_TOTALS: {\n    eventsToCount: [],\n    uniqueFields: [],\n    sumFields: [],\n  }\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Provide a list of fields you want to aggregate at the session level. These will end up in the ",(0,t.jsx)(n.code,{children:"int_ga4_sessions"})," ga4_sessions table in the corresponding struct within totals (e.g., totals.count, totals.distinct_count, totals.has_events, totals.sum)."]}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Customization"}),": Configure the ",(0,t.jsx)(n.code,{children:"eventsToCount"}),", ",(0,t.jsx)(n.code,{children:"uniqueFields"}),", and ",(0,t.jsx)(n.code,{children:"sumFields"})," arrays. You can use a simple string for the name or an object for more complex logic like renaming, filtering, or grouping events."]}),(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Column descriptions are auto-generated for session total fields based on the configuration!"})}),(0,t.jsxs)(n.p,{children:["Each array in ",(0,t.jsx)(n.code,{children:"CUSTOM_SESSION_TOTALS"})," supports multiple format options to accommodate different use cases. Choose the format that best fits your needs!"]}),(0,t.jsxs)(n.h5,{id:"events-to-count-eventstocount",children:["Events to Count (",(0,t.jsx)(n.code,{children:"eventsToCount"}),")"]}),(0,t.jsxs)(n.p,{children:["Counts occurrences of specific events per session. Results are stored in ",(0,t.jsx)(n.code,{children:"totals.count.*"})," and ",(0,t.jsx)(n.code,{children:"totals.has_event.*"})," in ",(0,t.jsx)(n.code,{children:"int_ga4_sessions"})," and ",(0,t.jsx)(n.code,{children:"ga4_sessions"})," tables."]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Supported Formats:"})}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Format"}),(0,t.jsx)(n.th,{children:"Use Case"}),(0,t.jsx)(n.th,{children:"Example"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"String"})}),(0,t.jsx)(n.td,{children:"Simple event counting"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"'page_view'"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Object with metadata"})}),(0,t.jsx)(n.td,{children:"Event counting with custom naming"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"{ name: 'sign_up', renameTo: 'registrations' }"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Object with event array"})}),(0,t.jsx)(n.td,{children:"Count multiple related events as one metric"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"{ name: ['video_start', 'video_progress'], renameTo: 'video_interactions' }"})})]})]})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available Fields:"})}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"})," (required): Event name(s) to count - string or array of strings"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"renameTo"})," (optional): Custom output column name"]}),"\n"]}),(0,t.jsxs)(n.h5,{id:"unique-fields-uniquefields",children:["Unique Fields (",(0,t.jsx)(n.code,{children:"uniqueFields"}),")"]}),(0,t.jsxs)(n.p,{children:["Counts distinct values of specified fields per session. Results are stored in ",(0,t.jsx)(n.code,{children:"totals.distinct_count.*"})," in ",(0,t.jsx)(n.code,{children:"int_ga4_sessions"})," and ",(0,t.jsx)(n.code,{children:"ga4_sessions"})," tables."]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Supported Formats:"})}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Format"}),(0,t.jsx)(n.th,{children:"Use Case"}),(0,t.jsx)(n.th,{children:"Example"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Object with field path"})}),(0,t.jsx)(n.td,{children:"Count unique values across all events"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"{ name: 'ecommerce.transaction_id', renameTo: 'unique_transactions' }"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Object with event filter"})}),(0,t.jsx)(n.td,{children:"Count unique values only from specific events"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"{ name: 'event_params.currency', eventFilter: ['purchase', 'refund'], renameTo: 'transaction_currencies' }"})})]})]})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available Fields:"})}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"})," (required): Field path to count unique values from"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"eventFilter"})," (optional): Limit counting to specific event types - string or array of strings"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"renameTo"})," (optional): Custom output column name"]}),"\n"]}),(0,t.jsxs)(n.h5,{id:"sum-fields-sumfields",children:["Sum Fields (",(0,t.jsx)(n.code,{children:"sumFields"}),")"]}),(0,t.jsxs)(n.p,{children:["Sums numeric values of specified fields per session. Results are stored in ",(0,t.jsx)(n.code,{children:"totals.sum.*"})," in ",(0,t.jsx)(n.code,{children:"int_ga4_sessions"})," and ",(0,t.jsx)(n.code,{children:"ga4_sessions"})," tables."]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Supported Formats:"})}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Format"}),(0,t.jsx)(n.th,{children:"Use Case"}),(0,t.jsx)(n.th,{children:"Example"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"String"})}),(0,t.jsx)(n.td,{children:"Simple field summation across all events"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"'event_params.video_duration'"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Object with metadata"})}),(0,t.jsx)(n.td,{children:"Field summation with custom naming"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"{ name: 'event_params.engagement_time_msec', renameTo: 'total_engagement' }"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Object with event filter"})}),(0,t.jsx)(n.td,{children:"Sum values only from specific events"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"{ name: 'ecommerce.purchase_revenue', eventFilter: ['purchase', 'refund'], renameTo: 'net_purchase_revenue' },"})})]})]})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available Fields:"})}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"})," (required): Field path to count unique values from"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"eventFilter"})," (optional): Limit counting to specific event types - string or array of strings"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"renameTo"})," (optional): Custom output column name"]}),"\n"]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"CUSTOM_SESSION_TOTALS: {\n  eventsToCount: [\n    'page_view',\n    { name: 'sign_up', renameTo: 'registrations', description: 'User registration events in session' },\n    { name: ['video_start', 'video_progress', 'video_complete'], renameTo: 'video_engagement', description: 'All video interaction events' }\n  ],\n  uniqueFields: [\n    { name: 'ecommerce.transaction_id', renameTo: 'unique_transactions', description: 'Number of unique transaction IDs in session' },\n    { name: 'event_params.currency', renameTo: 'funnel_currencies', eventFilter: ['begin_checkout', 'purchase'], description: 'Unique currencies used in checkout funnel' },\n  ],\n  sumFields: [\n    { name: 'event_params.engagement_time_msec', renameTo: 'total_engagement_time', description: 'Sum of engagement time in milliseconds' },\n    { name: 'ecommerce.purchase_revenue', eventFilter: ['purchase', 'refund'], renameTo: 'net_purchase_revenue' },\n  ]\n}\n"})}),(0,t.jsx)(n.admonition,{title:"Item fields are not (yet) supported!",type:"warning",children:(0,t.jsxs)(n.p,{children:["This will throw an error:",(0,t.jsx)("br",{}),"\n",(0,t.jsx)(n.code,{children:"{ name: \"items.item_params_custom.item_sku\", eventFilter: ['purchase'] }"})]})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Event and Hostname Filters"}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Events to Exclude"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"EVENTS_TO_EXCLUDE: []\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": List the event names that should be excluded from the events table.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Add event names you don\u2019t want to process.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Example:"})]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'EVENTS_TO_EXCLUDE: ["user_engagement", "scroll"]\n'})}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Hostname Exclude/Include"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"HOSTNAME_EXCLUDE: []\nHOSTNAME_INCLUDE_ONLY: []\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Exclude or include specific hostnames from the data.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Add hostnames to either list based on whether you want to include or exclude them from the data.\n",(0,t.jsx)(n.strong,{children:"Example:"})]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'HOSTNAME_EXCLUDE: []\nHOSTNAME_INCLUDE_ONLY: [ "www.ga4dataform.com", "ga4dataform.com" ]\n'})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Last Non-Direct Lookback Days"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"LAST_NON_DIRECT_LOOKBACK_DAYS: 90\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Defines the number of days to look back when assigning a source for a user who lands on your site without any known sources.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Change the number of days to your liking."]})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)("summary",{children:"Extra Channel Grouping"}),"\nWe\u2019ve implemented GA4\u2019s ",(0,t.jsx)(n.a,{href:"https://support.google.com/analytics/answer/9756891",children:"Default Channel Grouping"})," logic as a JavaScript function. While our implementation closely mirrors GA4's behavior, it may not provide exact matches in all cases. This is primarily because the BigQuery export does not include certain parameters that GA4 uses in its grouping logic, such as ",(0,t.jsx)(n.em,{children:"Source platform"})," and ",(0,t.jsx)(n.em,{children:"Google Ads campaign type"}),". As a result, discrepancies might appear between GA4 UI groupings and our classification."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"EXTRA_CHANNEL_GROUPS: true\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": If you enable this, ",(0,t.jsx)(n.code,{children:"session_source.first/last.default_channel_grouping"})," in ",(0,t.jsx)(n.code,{children:"int_ga4_sessions"})," and ",(0,t.jsx)(n.code,{children:"session_source.default_channel_grouping"})," in ",(0,t.jsx)(n.code,{children:"ga4_sessions"})," will use an ",(0,t.jsx)(n.strong,{children:"Organic AI"})," grouping based on a set list of matching AI-related referrer domains listed in ",(0,t.jsx)(n.code,{children:"includes/core/extra/source_categories.json"}),"."]})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"User stitching \ud83d\udc8e"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"USER_STITCHING: {\n  enabled: false,\n  dimensions: [],\n  lookBackDays: 90,\n  lookAheadDays: 10\n}\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),': The user stitching functionality looks at the cookie of the user (user_pseudo_id) and "fills in gaps" of certain column(s) - most notably the user_id. It does this on the ',(0,t.jsx)(n.strong,{children:"session level"}),"."]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"How it works:"})}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Lookback"}),": we look back in time to find if that visitor in the past has had a session with a ",(0,t.jsx)(n.code,{children:"user_id"}),", and assign that ",(0,t.jsx)(n.code,{children:"user_id"})," to the current session. The last seen ",(0,t.jsx)(n.code,{children:"user_id"})," is used to fill in the blanks."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Lookahead"}),": if there is no session in the past with a ",(0,t.jsx)(n.code,{children:"user_id"}),", we look in the future to find one. This effectively ",(0,t.jsx)(n.strong,{children:"rewrites the history"})," and de-anonimises sessions leading up to a login (caution is advised not to breach privacy regulations, policies)."]}),"\n",(0,t.jsxs)(n.li,{children:["Results are stored in the ",(0,t.jsx)(n.code,{children:"stitched_ids"})," struct column in the ",(0,t.jsx)(n.code,{children:"ga4_sessions"})," table."]}),"\n",(0,t.jsxs)(n.li,{children:["The stitching is not restricted to ",(0,t.jsx)(n.code,{children:"user_id"})," only: if you have (custom) parameters, user_properties, url_params, you can stitch them via the same procedure using the ",(0,t.jsx)(n.code,{children:"dimensions"})," array."]}),"\n",(0,t.jsxs)(n.li,{children:["We use ",(0,t.jsx)(n.code,{children:"user_pseudo_id"})," as the partition for the lookback and lookahead windows"]}),"\n"]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Configuration Options:"})}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"enabled"})}),(0,t.jsx)(n.td,{children:"Enable/disable user stitching functionality"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"dimensions"})}),(0,t.jsx)(n.td,{children:"Array of objects that contain additional fields to stitch beyond user_id"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"lookBackDays"})}),(0,t.jsx)(n.td,{children:"Days to search backwards for user identification (default: 90)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"lookAheadDays"})}),(0,t.jsx)(n.td,{children:"Days to search forward for retroactive identification (default: 10)"})]})]})]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Dimensions Format:"})}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"name"}),": the column name as it appears in ",(0,t.jsx)(n.code,{children:"ga4_events"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"renameTo"}),": the column name as it will appear in the ",(0,t.jsx)(n.code,{children:"stitched_ids"})," struct in ",(0,t.jsx)(n.code,{children:"ga4_sessions"})]}),"\n"]}),(0,t.jsx)(n.admonition,{title:"Field naming",type:"note",children:(0,t.jsxs)(n.p,{children:["If no ",(0,t.jsx)(n.code,{children:"renameTo"})," field is used, the full (sanitized) name is used. So ",(0,t.jsx)(n.code,{children:"event_params_custom.lead_id"})," will become ",(0,t.jsx)(n.code,{children:"event_params_custom_lead_id"}),"."]})}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'  USER_STITCHING: {\n    enabled: true,\n    dimensions: [\n\t    { name: "user_properties.datatrics_segment", renameTo: "datatrics_segment" },\n      { name: "event_params_custom.showroom_name" }\n    ],\n    lookBackDays: 90,\n    lookAheadDays: 3\n  }\n'})}),(0,t.jsx)(n.admonition,{title:"Respect user privacy",type:"warning",children:(0,t.jsx)(n.p,{children:"Be mindul of user choices and privacy when stitching data. If you use stitched data to enrich customer profiles with information gathered while they were logged out, it may not be what they expect. Or even what you promised in your own privacy policy."})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Custom Event ID Parameter \ud83d\udc8e"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"CUSTOM_EVENT_ID_PARAMETER: ''\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Use ",(0,t.jsx)(n.code,{children:"CUSTOM_EVENT_ID_PARAMETER"})," to add another custom event parameter that makes an event unique. This field will be concatenated with the default event_id fields and will ensure event uniqueness. We usually recommend using a UNIX timestamp or a custom event_id."]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Example:"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"CUSTOM_EVENT_ID_PARAMETER: 'event_params_custom.hit_timestamp'\n"})}),(0,t.jsxs)(n.p,{children:["Which will return this SQL in ",(0,t.jsx)(n.code,{children:"ga4_events"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"farm_fingerprint(\n    event_name || '-' ||\n    time.event_timestamp || '-' ||\n    coalesce(user_pseudo_id, 'no') || '-' ||\n    coalesce(event_params.ga_session_id, 0) || '-' ||\n    coalesce(batch.batch_page_id, 0) || '-' ||\n    coalesce(batch.batch_ordering_id,0) || '-' ||\n    coalesce(batch.batch_event_index,0) || '-' ||\n    coalesce(ecommerce.ecommerce_transaction_id, \"no\") || '-' ||\n    coalesce(event_params.engagement_time_msec, 0)\n    || safe_cast(coalesce(event_params_custom.hit_timestamp,'no') as string)\n  ) as event_id\n"})}),(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["Make sure to add the custom field you are using as ",(0,t.jsx)(n.code,{children:"CUSTOM_EVENT_ID_PARAMETER"})," to the ",(0,t.jsx)(n.code,{children:"CUSTOM_EVENT_PARAMS_ARRAY"})," as well!"]})})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Deduplicating Transactions"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"TRANSACTIONS_DEDUPE: true\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": By default, we leave duplicate transaction_ids alone in ",(0,t.jsx)(n.code,{children:"ga4_transactions"}),", but you can enable deduplication with this setting."]}),(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Setting this to true will still keep all transactions with NULL transaction_id"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Customization"}),": enable/disable"]})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Transaction Totals User Identifier"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"TRANSACTION_TOTALS_UID: 'user_pseudo_id'\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Description"}),": Specifies the user identifier field for calculating running transaction counts in ",(0,t.jsx)(n.code,{children:"ga4_transactions"}),".\n",(0,t.jsx)(n.strong,{children:"Customization"}),": Default identifier is ",(0,t.jsx)(n.code,{children:"user_pseudo_id"}),". Change to your preferred user identifier (e.g., ",(0,t.jsx)(n.code,{children:"user_id"})," for authenticated users). Ensure the specified column exists in your data."]})]}),"\n",(0,t.jsxs)(s,{children:[(0,t.jsx)("summary",{children:"Data Quality Assertions"}),(0,t.jsx)("p",{children:"These assertions check the data for consistency and quality. You can enable or disable specific checks by setting them to true or false."}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Event ID Uniqueness"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"ASSERTIONS_EVENT_ID_UNIQUENESS: true\n"})}),(0,t.jsx)(n.p,{children:"Ensures that each event has a unique event ID."}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Session ID Uniqueness"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"ASSERTIONS_SESSION_ID_UNIQUENESS: true\n"})}),(0,t.jsx)(n.p,{children:"Ensures that each session has a unique session ID."}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Session Duration Validity"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"ASSERTIONS_SESSION_DURATION_VALIDITY: true\n"})}),(0,t.jsx)(n.p,{children:"Ensures that session durations are valid and within reasonable limits."}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Session Validity"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"ASSERTIONS_SESSIONS_VALIDITY: true\n"})}),(0,t.jsx)(n.p,{children:"Validates that session data is correct."}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Tables Timeliness"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"ASSERTIONS_TABLES_TIMELINESS: true\n"})}),(0,t.jsx)(n.p,{children:"Checks if the GA4 tables are up to date."}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Transaction ID Completeness"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"ASSERTIONS_TRANSACTION_ID_COMPLETENESS: false\n"})}),(0,t.jsx)(n.p,{children:"Checks if transaction IDs are present for purchase events."}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"User Pseudo ID Completeness"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"ASSERTIONS_USER_PSEUDO_ID_COMPLETENESS: false\n"})}),(0,t.jsx)(n.p,{children:'Ensures that the "user_pseudo_id" is present for all hits.'}),(0,t.jsx)(n.admonition,{title:"Advanced Consent Mode",type:"warning",children:(0,t.jsx)(n.p,{children:"If you use Advanced Consent Mode, this assertion will always fail."})})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(6540);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);