"use strict";(self.webpackChunkga_4_dataform=self.webpackChunkga_4_dataform||[]).push([[7040],{3700:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var t=n(4848),r=n(8453);const i={title:"Custom Configuration",description:"Providing instructions on how to customize GA4Dataform.",slug:"/custom-configuration"},o=void 0,a={id:"core-concepts/custon-configuration",title:"Custom Configuration",description:"Providing instructions on how to customize GA4Dataform.",source:"@site/docs/core-concepts/custon-configuration.md",sourceDirName:"core-concepts",slug:"/custom-configuration",permalink:"/docs/custom-configuration",draft:!1,unlisted:!1,editUrl:"https://github.com/<your-org>/<your-repo>/edit/main/docs/docs/core-concepts/custon-configuration.md",tags:[],version:"current",frontMatter:{title:"Custom Configuration",description:"Providing instructions on how to customize GA4Dataform.",slug:"/custom-configuration"},sidebar:"tutorialSidebar",previous:{title:"Core Concepts",permalink:"/docs/category/core-concepts"},next:{title:"Installer",permalink:"/docs/installer"}},c={},l=[];function d(e){const s={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components},{Details:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"The Config: Part 1"}),"\n",(0,t.jsx)(s.p,{children:"The config in my honest opinion is the most important element we built into GA4Dataform by Superform Labs."}),"\n",(0,t.jsx)(s.p,{children:"With a proper config you can manage variables, modularize features without the need to overwrite anything in the core SQLX files."}),"\n",(0,t.jsx)(s.p,{children:"It's like a control panel of JavaScript variables that affect what the final SQL will look like."}),"\n",(0,t.jsx)(s.p,{children:"Think of things like start date, user properties, event- and item parameters to be unnested, events to filter out etc."}),"\n",(0,t.jsxs)(s.p,{children:["It also makes it possible to distribute the same Dataform repository without having to hardcode variables since they ... vary (",(0,t.jsx)(s.em,{children:"mild shock"}),")."]}),"\n",(0,t.jsx)(s.p,{children:"Another key aspect of a config is how to handle updates/changes."}),"\n",(0,t.jsx)(s.p,{children:"We may ship a bugfix or a new feature that requires a change in the config file. We cannot just overwrite it during install since there's already a live config."}),"\n",(0,t.jsx)(s.p,{children:"What then?"}),"\n",(0,t.jsx)(s.p,{children:"We can either:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"let users add the config themselves - we just add the modifications to the Core files (making sure that it works even without a modified config)"}),"\n",(0,t.jsx)(s.li,{children:"separate new configs to their own files - which makes it a bit harder to manage since they are more spread out"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"I think both options work - it highly depends on the feature's complexity and how much it affects Core files and functionality."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Does it require a rebuild (i.e. schema change occurs)?"}),"\n",(0,t.jsx)(s.li,{children:"Does it affect a Core table in any regard?"}),"\n",(0,t.jsx)(s.li,{children:"Is it a part of a completely separate Premium feature?"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"The definitions/custom/config.js file allows you to customize various aspects of the GA4Dataform models. You can control settings such as custom parameters, event filtering, hostname filtering, start date, and data validation checks."}),"\n",(0,t.jsxs)(s.p,{children:["If you are interested in seeing how these can be implemented after the install, take a look at the ",(0,t.jsx)(s.a,{href:"https://docs.ga4dataform.com/docs/post-installation-guide",children:"Post-Installation Guide"}),"!"]}),"\n",(0,t.jsx)(s.p,{children:"The Config: Part 2"}),"\n",(0,t.jsx)(s.p,{children:'A few days ago we started to discuss the logic behind "the config" of GA4Dataform by Superform Labs and how it makes variable management and modularization possible in Dataform.'}),"\n",(0,t.jsx)(s.p,{children:"Now, let's dive a bit more into the details!"}),"\n",(0,t.jsx)(s.p,{children:"If you have used GA4Dataform before, you have encountered 2 different configs:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"includes/core/default_config.js"}),"\n",(0,t.jsx)(s.li,{children:"includes/custom/config.js"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"What is up with that?"}),"\n",(0,t.jsx)(s.p,{children:"This is basically how we separated our config from yours."}),"\n",(0,t.jsx)(s.p,{children:"We use default_config.js to handle a few features like the listing of standard event parameters and standard click IDs that our Core models leverage by default."}),"\n",(0,t.jsx)(s.p,{children:"Since default_config.js is in the Core folder, it is subject to change.\nWe may update it when we introduce a new feature, and since you shouldn t change anything in it - we won t overwrite your config."}),"\n",(0,t.jsx)(s.p,{children:"We also use it to create fallback JavaScript variables.\nIf you delete something in config.js, a compilation error will occur since the code will reference a JS variable that is undefined."}),"\n",(0,t.jsx)(s.p,{children:"To avoid this, we create empty vars that are merged with your config so that even if something is removed from config.js - the repo still compiles."}),"\n",(0,t.jsx)(s.p,{children:"We achieve the merge of the 2 config objects with a JavaScript spread operator that prioritizes your config (config.js) over default_config.js."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'const getConfig = () => {\n const { coreConfig } = require("./default_config");\n const { customConfig } = require("../custom/config");\n return { ...coreConfig, ...customConfig };\n};\n'})}),"\n",(0,t.jsx)(s.p,{children:"So if you set your variables in config.js - your values will always take precedence!"}),"\n",(0,t.jsx)(s.p,{children:"Click on each card below to see more details!"}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"GA4 Start Date"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:'GA4_START_DATE: "2020-01-01"\n'})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)("strong",{children:"Description"}),": Defines the starting date for the GA4 data that the model should process.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Customization"}),": Change this date to reflect the earliest data you want to include in your reports. For example, if you started collecting GA4 data on a different date, modify this to match that date."]})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Custom Event Parameters"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"CUSTOM_EVENT_PARAMS_ARRAY: []\n"})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)("strong",{children:"Description"}),": This allows you to specify custom event parameters that are not part of the standard GA4 data. The custom parameters will be added to the ",(0,t.jsx)(s.code,{children:"event_params_custom"})," column.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Customization"}),": Add parameters using the format ",(0,t.jsx)(s.code,{children:'"{ name: "paramname", type: "TYPE", renameTo: "outputcolumnname" }"'}),"."]}),(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Field"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"The original event parameter name to extract"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"type"}),(0,t.jsxs)(s.td,{children:["Data type for extraction and storage. ",(0,t.jsx)(s.code,{children:"int"}),": Extracts from int_value, stores as INT; ",(0,t.jsx)(s.code,{children:"string"}),": Extracts from all values, stores as STRING; ",(0,t.jsx)(s.code,{children:"decimal"}),": Extracts from all numerical values, stores as FLOAT"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"renameTo"}),(0,t.jsx)(s.td,{children:"Optional - New name for the output column. If not specified, original parameter name is used"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"cleaningMethod"}),(0,t.jsxs)(s.td,{children:["Optional - Transformation method to apply: ",(0,t.jsx)(s.code,{children:"lowerSQL"}),": Converts string outputs to lowercase"]})]})]})]}),(0,t.jsx)("strong",{children:"Example:"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"CUSTOM_EVENT_PARAMS_ARRAY: [\n  { name: 'custom_param', type: 'string', renameTo: 'custom_output' },\n  { name: 'n_items', type: 'int' }\n]\n"})})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Custom Item Parameters"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"CUSTOM_ITEM_PARAMS_ARRAY: []\n"})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)("strong",{children:"Description"}),": Similar to event parameters, but for item custom dimensions and metrics. These will be stored in the ",(0,t.jsx)(s.code,{children:"items.item_params_custom.*"})," column.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Customization"}),": Add custom item parameters in the same format."]}),(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Field"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"The original item parameter name to extract"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"type"}),(0,t.jsxs)(s.td,{children:["Data type for extraction and storage. ",(0,t.jsx)(s.code,{children:"int"}),": Extracts from int_value, stores as INT; ",(0,t.jsx)(s.code,{children:"string"}),": Extracts from all values, stores as STRING; ",(0,t.jsx)(s.code,{children:"decimal"}),": Extracts from all numerical values, stores as FLOAT"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"renameTo"}),(0,t.jsx)(s.td,{children:"Optional - New name for the output column. If not specified, original parameter name is used"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"cleaningMethod"}),(0,t.jsxs)(s.td,{children:["Optional - Transformation method to apply: ",(0,t.jsx)(s.code,{children:"lowerSQL"}),": Converts string outputs to lowercase"]})]})]})]}),(0,t.jsx)("strong",{children:"Example:"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:'CUSTOM_ITEM_PARAMS_ARRAY: [\n  { name: "stock_status", type: "string" }\n]\n'})})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Custom URL Parameters"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"CUSTOM_URL_PARAMS_ARRAY: []\n"})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)("strong",{children:"Description"}),": Allows you to extract custom URL parameters into their own columns.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Customization"}),": Define custom URL parameters you want to extract in the format ",(0,t.jsx)(s.code,{children:'"{ name: "param_name", cleaningMethod: method }"'}),". Note that URL params will always be strings. These will be stored in the ",(0,t.jsx)(s.code,{children:"url_params_custom"})," column.\n",(0,t.jsx)("strong",{children:"Cleaning Methods"}),": For now, the only cleaning method supported is ",(0,t.jsx)(s.code,{children:"lowerSQL"}),". This will transform the string to lower case. Note: use ",(0,t.jsx)(s.code,{children:"lowerSQL"})," without quotes."]}),(0,t.jsx)("strong",{children:"Example:"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:'CUSTOM_URL_PARAMS_ARRAY: [\n  { name: "q", cleaningMethod: lowerSQL },\n  { name: "product-size", renameTo: "size" }\n]\n'})})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"User Properties"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"CUSTOM_USER_PROPERTIES_ARRAY: []\n"})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)("strong",{children:"Description"}),": Allows you to extract user properties into their own columns.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Customization"}),": Define user properties you want to extract in the format ",(0,t.jsx)(s.code,{children:'"{ name: "param_name", cleaningMethod: method }"'}),". These will be stored in the ",(0,t.jsx)(s.code,{children:"user_properties"})," column."]}),(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Field"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"The original user property name to extract"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"type"}),(0,t.jsxs)(s.td,{children:["Data type for extraction and storage. ",(0,t.jsx)(s.code,{children:"int"}),": Extracts from int_value, stores as INT; ",(0,t.jsx)(s.code,{children:"string"}),": Extracts from all values, stores as STRING; ",(0,t.jsx)(s.code,{children:"decimal"}),": Extracts from all numerical values, stores as FLOAT"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"renameTo"}),(0,t.jsx)(s.td,{children:"Optional - New name for the output column. If not specified, original parameter name is used"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"cleaningMethod"}),(0,t.jsxs)(s.td,{children:["Optional - Transformation method to apply: ",(0,t.jsx)(s.code,{children:"lowerSQL"}),": Converts string outputs to lowercase"]})]})]})]}),(0,t.jsx)("strong",{children:"Example:"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:'  CUSTOM_USER_PROPERTIES_ARRAY: [\n  { name: "lifetime_value",   type: "decimal" },\n  { name: "membership_status", renameTo: "membership" }\n]\n'})})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Event and Hostname Filters"}),(0,t.jsx)("strong",{children:"Events to Exclude"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"EVENTS_TO_EXCLUDE: []\n"})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)("strong",{children:"Description"}),": List the event names that should be excluded from the events table.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Customization"}),": Add event names you don\u2019t want to process.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Example:"})]}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:'EVENTS_TO_EXCLUDE: ["user_engagement", "scroll"]\n'})}),(0,t.jsx)("strong",{children:"Hostname Exclude/Include"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"HOSTNAME_EXCLUDE: []\nHOSTNAME_INCLUDE_ONLY: []\n"})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)("strong",{children:"Description"}),": Exclude or include specific hostnames from the data.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Customization"}),": Add hostnames to either list based on whether you want to include or exclude them from the data.\n",(0,t.jsx)("strong",{children:"Example:"})]}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:'HOSTNAME_EXCLUDE: []\nHOSTNAME_INCLUDE_ONLY: [ "www.ga4dataform.com", "ga4dataform.com" ]\n'})})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Last Non-Direct Lookback Days"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"LAST_NON_DIRECT_LOOKBACK_DAYS: 90\n"})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)("strong",{children:"Description"}),": Defines the number of days to look back when assigning a source for a user who lands on your site without any known sources.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Customization"}),": Change the number of days to your liking."]})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Extra channel grouping"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"EXTRA_CHANNEL_GROUPS: true,\n"})}),(0,t.jsxs)(s.p,{children:[(0,t.jsx)("strong",{children:"Description"}),": Generate new channel group not available in GA4.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)("strong",{children:"Customization"}),": disable/enable."]})]}),"\n",(0,t.jsxs)(n,{children:[(0,t.jsx)("summary",{children:"Data Quality Assertions"}),(0,t.jsx)("p",{children:"These assertions check the data for consistency and quality. You can enable or disable specific checks by setting them to true or false."}),(0,t.jsx)("strong",{children:"Event ID Uniqueness"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"ASSERTIONS_EVENT_ID_UNIQUENESS: true\n"})}),(0,t.jsx)(s.p,{children:"Ensures that each event has a unique event ID."}),(0,t.jsx)("strong",{children:"Session ID Uniqueness"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"ASSERTIONS_SESSION_ID_UNIQUENESS: true\n"})}),(0,t.jsx)(s.p,{children:"Ensures that each session has a unique session ID."}),(0,t.jsx)("strong",{children:"Session Duration Validity"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"ASSERTIONS_SESSION_DURATION_VALIDITY: true\n"})}),(0,t.jsx)(s.p,{children:"Ensures that session durations are valid and within reasonable limits."}),(0,t.jsx)("strong",{children:"Session Validity"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"ASSERTIONS_SESSIONS_VALIDITY: true\n"})}),(0,t.jsx)(s.p,{children:"Validates that session data is correct."}),(0,t.jsx)("strong",{children:"Tables Timeliness"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"ASSERTIONS_TABLES_TIMELINESS: true\n"})}),(0,t.jsx)(s.p,{children:"Checks if the GA4 tables are up to date."}),(0,t.jsx)("strong",{children:"Transaction ID Completeness"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"ASSERTIONS_TRANSACTION_ID_COMPLETENESS: false\n"})}),(0,t.jsx)(s.p,{children:"Checks if transaction IDs are present for purchase events."}),(0,t.jsx)("strong",{children:"User Pseudo ID Completeness"}),(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-js",children:"ASSERTIONS_USER_PSEUDO_ID_COMPLETENESS: false\n"})}),(0,t.jsx)(s.p,{children:'Ensures that the "user_pseudo_id" is present for all hits.'}),(0,t.jsx)(s.admonition,{title:"Advanced Consent Mode",type:"warning",children:(0,t.jsx)(s.p,{children:"If you use Advanced Consent Mode, this assertion will always fail."})})]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>a});var t=n(6540);const r={},i=t.createContext(r);function o(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);